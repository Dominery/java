# CPU缓存模型

### 高速缓存

处理器处理能力上要远胜于主内存（DRAM），为了弥补处理器与主内存处理能力之间的鸿沟，引入了高速缓存（Cache)，来保存一些CPU从内存读取的数据，下次用到该数据直接从缓存中获取即可，以加快读取速度。

#### 缓存类型

| 缓存名称             | 是还共享           | 描述                                                         |
| -------------------- | ------------------ | ------------------------------------------------------------ |
| 一级缓存（L1 Cache） | CPU CORE独享       | 制造成本很高因此它的容量有限，但是读取速度很快               |
| 二级缓存（L2 Cache） | CPU CORE独享       | 是一级缓存的缓冲器,存储那些CPU处理时需要用到、一级缓存又无法存储的数据，读取速度低于一级缓存 |
| 三级缓存（L3 Cache） | 多个CPU CORE共享的 | 可以看作是二级缓存的缓冲器，读写速度低于二级缓存，CPU主要通过三级缓存与总线通信 |

#### 缓存一致性

随着多核时代的到来，每块CPU都有多个内核，每个内核都有自己的缓存，这样就会出现同一个数据的副本就会存在于多个缓存中，在读写的时候就会出现数据不一致的情况。

缓存一致性协议用来解决数据不一致问题。每个处理器通过嗅探在总线上传播的数据来检查自己缓存的值是不是过期了，当处理器发现自己缓存行对应的内存地址被修改，就会将当前处理器的缓存行设置成无效状态，当处理器对这个数据进行修改操作的时候，会重新从系统内存中把数据读到处理器缓存里。