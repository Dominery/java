# 阻塞队列

对于许多线程问题，可以通过使用一个或多个队列以优雅且安全的方式将其形式化。生产者线程向队列插入元素，消费者线程则取出它们。使用队列，可以安全地从一个线程向另一个线程传递数据。

当试图向队列添加元素而队列已满，或是想从队列移出元素而队列为空的时候，阻塞队列（blocking queue）导致线程阻塞。

### 阻塞队列方法

| 方法  | 说明                 | 特殊情况                        |
| ----- | -------------------- | ------------------------------- |
| offer | 添加一个元素         | 如果队列满，返回false，否则true |
| peek  | 返回队列头元素       | 如果队列空，返回null            |
| poll  | 移出并返回队列头元素 | 如果队列空，返回null            |
| put   | 添加一个元素         | 如果队列满，阻塞                |
| take  | 移出并返回头元素     | 如果队列空，阻塞                |

offer方法和poll方法可以设置超时时间。

### 实现类

java.util.concurrent包提供了阻塞队列的几个变种。

* LinkedBlockingQueue

  默认情况下，容量没有上限，但是，也可以选择指定最大容量。LinkedBlockingDeque是一个双端的版本。

* ArrayBlockingQueue

  在构造时需要指定容量，并且有一个可选的参数来指定是否需要公平性。

* PriorityBlockingQueue

  一个带优先级的队列，而不是先进先出队列。元素按照它们的优先级顺序被移出。该队列是没有容量上限，但是，如果队列是空的，取元素的操作会阻塞。

* DelayQueue

  包含实现Delayed接口的对象

  > Delayed接口是一个只有getDelay方法的接口。
  >
  > getDelay方法返回对象的残留延迟。负值表示延迟已经结束。元素只有在延迟用完的情况下才能从DelayQueue移除。

* LinkedTransferQueue

  Java SE 7增加了一个TransferQueue接口，允许生产者线程等待，直到消费者准备就绪可以接收一个元素。LinkedTransferQueue实现了该接口，如果生产者调用transfer(item)会阻塞，直到另一个线程将元素删除。













